<head>
  <!-- Link to the external CSS file -->
  <link rel="stylesheet" type="text/css" href="style.css">

  <script>
    // This function validates the user input and returns a float value
    function getFloatInput(id, message) {
      var input = document.getElementById(id).value;
      var num = parseFloat(input);
      if (isNaN(num)) {
        alert("Invalid input. Please enter valid credentials.");
        return null;
      } else {
        return num;
      }
    }

    // This function validates the user input and returns an integer value
    function getIntInput(id, message) {
      var input = document.getElementById(id).value;
      var num = parseInt(input);
      if (isNaN(num) || num < 1 || num > 4) {
        alert("Invalid input. Please enter a number between 1 and 4.");
        return null;
      } else {
        return num;
      }
    }

    // This function calculates the dosage based on the weight and the med
    function calculateDosage(weight, med, age) {
      var dosage = 0;
      var ageSelect = document.getElementById("ageSelect");
      var age = ageSelect.value;
      // Convert the med parameter to a number
      med = Number(med);
      if (med == 2) {
        dosage = 12 * weight;
      } else if (med == 3) {
        dosage = 4 * weight;
      } else if (med == 4) {
        dosage = 18 * weight;
      } else if (med == 5 && age == 1){
        dosage = 25 * weight
      } else if (med == 7) {
          dosage = 5 * weight
      } else if (med == 8) {
        dosage = 7 * weight
      } else if (med == 9) {
        dosage = 12 * weight
      } else if (med == 10) {
        dosage = getFloatInput("dosage", "Please input dosage in mg/kg manually");
      }
      return dosage;
    }

    // This function calculates the volume based on the dosage and the concentration
    function calculateVolume(dosage, concentration) {
      var volume = dosage / concentration;
      return volume;
    }

    // This function displays the results on the web page
    function displayResults(dosage, volume, age, med) {
      var med = document.getElementById("meds");
      var med = med.value;
      var ageSelect = document.getElementById("ageSelect");
      var age = ageSelect.value
      if (med == 3) {
        document.getElementById("result").innerHTML =
        "The total dose is " + dosage + " mg.<br>The volume is " + volume + " ml. BD with a maximum dosage of 400mg/day.";
      } else if (med == 4) {
        document.getElementById("result").innerHTML =
        "The total dose is " + dosage + " mg.<br>The volume is " + volume + " ml. BD with a maximum dosage of 875mg/dose.";
      } else if (med == 5 && age == 1) {
        document.getElementById("result").innerHTML = "The dosage is whatever is lower among " + dosage +"mg TID or 50mg TID for no more than 7 days.<br> Volume is "+ volume +"ml TID or 2.5ml TID: the lower one among the two.";
      }else if (med == 5 && age == 2) {
        document.getElementById("result").innerHTML = "The dosage should be 100mg 1-3 times daily upto 7 days.";
      } else if (med == 5 && age == 3) {
        document.getElementById("result").innerHTML = "The dosage should be 150mg 1-3 times daily upto 7 days.";
      } else if (med == 5 && age == 4) {
        document.getElementById("result").innerHTML = "The dosage should be 200mg 1-3 times daily upto 7 days.";
      } else if (med == 5 && age == 5) {
        document.getElementById("result").innerHTML = "The dosage should be a Tablet of 500mg TID daily upto 7 days.";
      } else if (med == 6 && age == 1) {
        document.getElementById("result").innerHTML = "5-10mg TID fed 15mins before feed and a maximum dosage of 20mg/day.";
      } else if (med == 6 && age == 2) {
        document.getElementById("result").innerHTML = "10mg TID or QID with maximum dosage of 40mg/day.";
      } else if (med == 6 && age == 3) {
        document.getElementById("result").innerHTML = "10mg TID or QID with maximum dosage of 40mg/day.";
      } else if (med == 6 && age == 4) {
        document.getElementById("result").innerHTML = "10mg TID or QID with maximum dosage of 40mg/day.";
      } else if (med == 6 && age == 5) {
        document.getElementById("result").innerHTML = "10-20mg TID or QID for maximum of 2 weeks.";
      } else if (med == 7) {
        document.getElementById("result").innerHTML = "The total dose is " + dosage +"mg BD.<br>The volume is " + volume +" ml BD with a usual maximum dose of 200mg/dose.<br>For adolescents above 12 years,sometimes a maximum dosage of 400mg/dose may be required.";
      } else if (med == 8 && age == 1) {
        document.getElementById("result").innerHTML = "The total dose is "+ dosage +"mg and volume is "+ volume +"ml every 6-8 hours with maximum single dose of 400mg and maximum dosage of 40mg/kg/day. This holds true upto patients of 50kg of weight.";
      } else if (med == 8 && age == 1) {
        document.getElementById("result").innerHTML = "The total dose is "+ dosage +"mg and volume is "+ volume +"ml every 6-8 hours with maximum single dose of 400mg and maximum dosage of 40mg/kg/day. This holds true upto patients of 50kg of weight.";
      } else if (med == 8 && age == 2) {
        document.getElementById("result").innerHTML = "The total dose is "+ dosage +"mg and volume is "+ volume +"ml every 6-8 hours with maximum single dose of 400mg and maximum dosage of 40mg/kg/day. This holds true upto patients of 50kg of weight.";
      } else if (med == 8 && age == 3) {
        document.getElementById("result").innerHTML = "The total dose is "+ dosage +"mg and volume is "+ volume +"ml every 6-8 hours with maximum single dose of 400mg and maximum dosage of 40mg/kg/day. This holds true upto patients of 50kg of weight.";
      } else if (med == 8 && age == 4) {
        document.getElementById("result").innerHTML = "The total dose is "+ dosage +"mg and volume is "+ volume +"ml every 6-8 hours with maximum single dose of 400mg and maximum dosage of 40mg/kg/day. This holds true upto patients of 50kg of weight.";
      } else if (med == 8 && age == 5) {
        document.getElementById("result").innerHTML = "200mg every 6 hours and maybe increased to 400mg if pain doesn't respond, with a maximum dosage of 1200mg/day. Treatment should be discontinued if there is no response for 10 days.";
      } else if (med == 9) {
        document.getElementById("result").innerHTML = "The total dose is "+ dosage +"mg TID.<br>Volume is "+ volume +"ml TID with a maximum dosage of 2250mg/day."
      } else {
        document.getElementById("result").innerHTML =
        "The total dose is " + dosage + " mg.<br>The volume is " + volume + " ml.";
      }
    }

    // This function handles the submit event of the form
    function handleSubmit(event) {
      event.preventDefault(); // prevent the default action of the form
      var weight = getFloatInput("weight", "Enter the patient's weight in kg");
      if (weight != null) {
        // Get the select element by id
        var select = document.getElementById("meds");
        // Get the value of the selected option
        var med = select.value;
        // Check if the user selected a medication
        if (med != "") {
          var dosage = calculateDosage(weight, med);
          if (dosage != null) {
            var concentration = getFloatInput(
              "concentration",
              "Enter the concentration in mg/ml"
            );
            if (concentration != null) {
              var volume = calculateVolume(dosage, concentration);
              displayResults(dosage, volume);
            }
          }
        } else {
          alert("Please select a medication.");
        }
      }
    }

    // This function shows or hides the dosage input and the dosage text based on the selected option
    function toggleDosage() {
      // Get the select element by id
      var select = document.getElementById("meds");
      // Get the value of the selected option
      var med = select.value;
      // Get the dosage input element by id
      var ageWhat = document.getElementById("ageWhat");
      
      var dosage = document.getElementById("dosage");
      // Get the dosage text element by id
      var dosageText = document.getElementById("dosageText");
      // Check if the selected option is 5 (others)
      if (med == 5 || med == 6 || med == 8) {
        ageWhat.style.display = "block";
      }
      else {
        ageWhat.style.display = "none";
      }
      if (med == 10) {
        // Show the dosage input and the dosage text
        dosage.style.display = "block";
        dosageText.style.display = "block";
      } else {
        // Hide the dosage input and the dosage text
        dosage.style.display = "none";
        dosageText.style.display = "none";
      }
    }
    function toggleAge() {
      var ageSelect = document.getElementById("ageSelect");
      if (med == 5 || med == 6 || med == 8) {
        ageSelect.style.display = "block";
      } else {
        ageSelect.style.display = "none";
      }
    }
  </script>
</head>
<body>
  <h1 class="center">Pae_do</h1>
  <h2 class="center">Paediatric dosage calculator</h2>
  <form id="form" onsubmit="handleSubmit(event)">
    <label for="meds">Choose a medication:</label>
    <select name="meds" id="meds" onchange="toggleDosage()">
      <option value="" hidden>--select--</option>
      <option value="2">Paracetamol</option>
      <option value="3">cefixime</option>
      <option value="4">Amoxclav/amoxicillin</option>
      <option value="5">Mefenemic Acid</option>
      <option value="6">Dicycloverine</option>
      <option value="7">Cefpodoxime</option>
      <option value="8">Ibuprofen</option>
      <option value="9">Metronidazole</option>
      <option value="10">Others</option>
    </select>
    <!-- Add an id attribute to the paragraph element -->
    <div id="ageWhat" style="Display: none">
    <label for="ageSelect">Choose age:</label>
    <select id="ageSelect" onchange="toggleAge()">
      <option value="" hidden>--select--</option>
      <option value= "1">>6months to <2years </option>
      <option value= "2">2years to <5years</option>
      <option value="3">5years to <9years</option>
      <option value="4">9years to <12years</option>
      <option value="5">>=12 years</option>
    </select>
    </div>
    <p>Enter the patient's weight in kg:</p>
    <input type="text" id="weight">
    <p id="dosageText">If you chose others, please input dosage in mg/kg manually:</p>
    <input type="text" id="dosage" style="display: none">
    <p>Enter the concentration in mg/ml:</p>
    <input type="text" id="concentration">
    <p><input type="submit" value="Calculate"></p>
  </form>
  <div id="result"></div>
</body>
